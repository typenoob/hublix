"use strict";(self["webpackChunkhublix"]=self["webpackChunkhublix"]||[]).push([[634],{6121:function(e,t,l){l.r(t),l.d(t,{default:function(){return N}});var a=l(3396),n=l(7139),u=l(1634),o=l(5032),i=l(3369),s=l(6824),r=l(8521);const c=(0,a.Uk)("搜索历史"),v=(0,a.Uk)("清空");function d(e,t,l,d,p,m){const f=(0,a.up)("SearchWidget"),h=(0,a.up)("MovieCard");return(0,a.wg)(),(0,a.j4)(i.K,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,{onIdSearched:m.getId},null,8,["onIdSearched"]),(0,a.Wm)(u._,{class:"pt-4 px-2 mb-10",flat:""},{default:(0,a.w5)((()=>[(0,a.Wm)(s.o,{class:""},{default:(0,a.w5)((()=>[(0,a.Wm)(r.D,null,{default:(0,a.w5)((()=>[c])),_:1}),(0,a.Wm)(r.D,{class:"d-flex justify-end",onClick:t[0]||(t[0]=e=>m.clearHistory()),style:{}},{default:(0,a.w5)((()=>[v])),_:1})])),_:1}),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(p.history,((e,t)=>((0,a.wg)(),(0,a.j4)(o.v,{class:"ma-2",key:t,onClick:t=>p.id=e.id,"x-small":""},{default:(0,a.w5)((()=>[(0,a.Uk)((0,n.zw)(e.name),1)])),_:2},1032,["onClick"])))),128))])),_:1}),(0,a.Wm)(h,{id:p.id},null,8,["id"])])),_:1})}l(1703),l(6699),l(2262),l(4506);var p=l(7540),m=l(5477),f=l(836),h=l(4959),y=l(5547),g=l(7653),k=l(1347),w=l(165),C=l(3185),F=l(3766),S=l(131),W=l(4870);const b=(e,t,l)=>null==e||null==t?-1:e.toString().toLocaleLowerCase().indexOf(t.toString().toLocaleLowerCase()),x=(0,F.U)({customFilter:Function,customKeyFilter:Object,filterKeys:[Array,String],filterMode:{type:String,default:"intersection"},noFilter:Boolean},"filter");function _(e,t,l){const a=[],n=l?.default??b,u=!!l?.filterKeys&&(0,S.FT)(l.filterKeys),o=Object.keys(l?.customKeyFilter??{}).length;if(!e?.length)return a;e:for(let i=0;i<e.length;i++){const s=e[i],r={},c={};let v=-1;if(t&&!l?.noFilter){if("object"===typeof s){const e=u||Object.keys(s);for(const a of e){const e=(0,S.qF)(s,a,s),u=l?.customKeyFilter?.[a];if(v=u?u(e,t,s):n(e,t,s),-1!==v&&!1!==v)u?r[a]=v:c[a]=v;else if("every"===l?.filterMode)continue e}}else v=n(s,t,s),-1!==v&&!1!==v&&(c.title=v);const e=Object.keys(c).length,a=Object.keys(r).length;if(!e&&!a)continue;if("union"===l?.filterMode&&a!==o&&!e)continue;if("intersection"===l?.filterMode&&(a!==o||!e))continue}a.push({index:i,matches:{...c,...r}})}return a}function I(e,t,l,n){const u=(0,a.Fl)((()=>"string"!==typeof l?.value&&"number"!==typeof l?.value?"":String(l.value))),o=(0,W.iH)([]),i=(0,W.iH)(new Map),s=(0,a.Fl)((()=>n?.transform?(0,W.SU)(t).map(n?.transform):(0,W.SU)(t)));function r(e){return i.value.get(e.value)}return(0,a.m0)((()=>{o.value=[],i.value=new Map;const l=_(s.value,u.value,{customKeyFilter:e.customKeyFilter,default:e.customFilter,filterKeys:e.filterKeys,filterMode:e.filterMode,noFilter:e.noFilter}),a=(0,W.SU)(t);l.forEach((e=>{let{index:t,matches:l}=e;const n=a[t];o.value.push(n),i.value.set(n.value,l)}))})),{filteredItems:o,filteredMatches:i,getMatches:r}}var D=l(4906),M=l(4357),U=l(4019),V=l(1629),H=l(8717),K=l(2370),A=l(1107),L=l(9888);function j(e,t,l){if(null==t)return e;if(Array.isArray(t))throw new Error("Multiple matches is not implemented");return"number"===typeof t&&~t?(0,a.Wm)(a.HY,null,[(0,a.Wm)("span",{class:"v-autocomplete__unmask"},[e.substr(0,t)]),(0,a.Wm)("span",{class:"v-autocomplete__mask"},[e.substr(t,l)]),(0,a.Wm)("span",{class:"v-autocomplete__unmask"},[e.substr(t+l)])]):e}const O=(0,F.U)({autoSelectFirst:{type:[Boolean,String]},search:String,...x({filterKeys:["title"]}),...(0,p.fL)(),...(0,S.CE)((0,w.w)({modelValue:null}),["validationValue","dirty","appendInnerIcon"]),...(0,D.X)({transition:!1})},"v-autocomplete"),T=(0,A.ev)()({name:"VAutocomplete",props:O(),emits:{"update:focused":e=>!0,"update:search":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,t){let{slots:l}=t;const{t:n}=(0,V.bU)(),u=(0,W.iH)(),i=(0,W.XI)(!1),s=(0,W.XI)(!0),r=(0,W.iH)(!1),c=(0,W.iH)(),v=(0,H.z)(e,"menu"),d=(0,a.Fl)({get:()=>v.value,set:e=>{v.value&&!e&&c.value?.ΨopenChildren||(v.value=e)}}),p=(0,W.XI)(-1),F=(0,a.Fl)((()=>u.value?.color)),{items:b,transformIn:x,transformOut:_}=(0,U.Ce)(e),{textColorClasses:D,textColorStyles:A}=(0,K.rY)(F),O=(0,H.z)(e,"search",""),T=(0,H.z)(e,"modelValue",[],(e=>x((0,S.FT)(e))),(t=>{const l=_(t);return e.multiple?l:l[0]??null})),Y=(0,M.cI)(),{filteredItems:E,getMatches:P}=I(e,b,(0,a.Fl)((()=>s.value?void 0:O.value))),Z=(0,a.Fl)((()=>T.value.map((t=>b.value.find((l=>e.valueComparator(l.value,t.value)))||t)))),z=(0,a.Fl)((()=>e.hideSelected?E.value.filter((e=>!Z.value.some((t=>t.value===e.value)))):E.value)),R=(0,a.Fl)((()=>Z.value.map((e=>e.props.value)))),X=(0,a.Fl)((()=>Z.value[p.value])),B=(0,a.Fl)((()=>{const t=!0===e.autoSelectFirst||"exact"===e.autoSelectFirst&&O.value===z.value[0]?.title;return t&&z.value.length>0&&!s.value&&!r.value})),G=(0,W.iH)();function N(t){e.openOnClear&&(d.value=!0),O.value=""}function q(){e.hideNoData&&!b.value.length||e.readonly||Y?.isReadonly.value||(d.value=!0)}function $(e){i.value&&(e.preventDefault(),e.stopPropagation()),d.value=!d.value}function J(t){if(e.readonly||Y?.isReadonly.value)return;const l=u.value.selectionStart,a=R.value.length;if((p.value>-1||["Enter","ArrowDown","ArrowUp"].includes(t.key))&&t.preventDefault(),["Enter","ArrowDown"].includes(t.key)&&(d.value=!0),["Escape"].includes(t.key)&&(d.value=!1),["Enter","Escape","Tab"].includes(t.key)&&(B.value&&["Enter","Tab"].includes(t.key)&&ne(E.value[0]),s.value=!0),"ArrowDown"===t.key?(G.value?.focus("next"),B.value&&G.value?.focus("next")):"ArrowUp"===t.key&&G.value?.focus("prev"),e.multiple){if(["Backspace","Delete"].includes(t.key)){if(p.value<0)return void("Backspace"!==t.key||O.value||(p.value=a-1));const e=p.value;X.value&&ne(X.value),p.value=e>=a-1?a-2:e}if("ArrowLeft"===t.key){if(p.value<0&&l>0)return;const e=p.value>-1?p.value-1:a-1;Z.value[e]?p.value=e:(p.value=-1,u.value.setSelectionRange(O.value?.length,O.value?.length))}if("ArrowRight"===t.key){if(p.value<0)return;const e=p.value+1;Z.value[e]?p.value=e:(p.value=-1,u.value.setSelectionRange(0,0))}}}function Q(e){O.value=e.target.value}function ee(){i.value&&(s.value=!0,u.value?.focus())}function te(e){i.value=!0,setTimeout((()=>{r.value=!0}))}function le(e){r.value=!1}const ae=(0,W.XI)(!1);function ne(t){if(e.multiple){const l=R.value.findIndex((l=>e.valueComparator(l,t.value)));if(-1===l)T.value=[...T.value,t];else{const e=[...T.value];e.splice(l,1),T.value=e}}else T.value=[t],ae.value=!0,O.value=t.title,d.value=!1,s.value=!0,(0,a.Y3)((()=>ae.value=!1))}return(0,a.YP)(i,((t,l)=>{t!==l&&(t?(ae.value=!0,O.value=e.multiple?"":String(Z.value.at(-1)?.props.title??""),s.value=!0,(0,a.Y3)((()=>ae.value=!1))):(e.multiple||O.value?!B.value||r.value||Z.value.some((e=>{let{value:t}=e;return t===z.value[0].value}))||ne(z.value[0]):T.value=[],d.value=!1,O.value="",p.value=-1))})),(0,a.YP)(O,(e=>{i.value&&!ae.value&&(e&&(d.value=!0),s.value=!e)})),(0,L.L)((()=>{const t=!(!e.chips&&!l.chip),r=!!(!e.hideNoData||z.value.length||l.prepend||l.append||l["no-data"]),v=T.value.length>0,[C]=w.h.filterProps(e);return(0,a.Wm)(w.h,(0,a.dG)({ref:u},C,{modelValue:O.value,"onUpdate:modelValue":e=>{null==e&&(T.value=[])},focused:i.value,"onUpdate:focused":e=>i.value=e,validationValue:T.externalValue,dirty:v,onInput:Q,class:["v-autocomplete","v-autocomplete--"+(e.multiple?"multiple":"single"),{"v-autocomplete--active-menu":d.value,"v-autocomplete--chips":!!e.chips,"v-autocomplete--selection-slot":!!l.selection,"v-autocomplete--selecting-index":p.value>-1},e.class],style:e.style,readonly:e.readonly,placeholder:v?void 0:e.placeholder,"onClick:clear":N,"onMousedown:control":q,onKeydown:J}),{...l,default:()=>(0,a.Wm)(a.HY,null,[(0,a.Wm)(k.T,(0,a.dG)({ref:c,modelValue:d.value,"onUpdate:modelValue":e=>d.value=e,activator:"parent",contentClass:"v-autocomplete__content",eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:ee},e.menuProps),{default:()=>[r&&(0,a.Wm)(y.i,{ref:G,selected:R.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:e=>e.preventDefault(),onFocusin:te,onFocusout:le},{default:()=>[!z.value.length&&!e.hideNoData&&(l["no-data"]?.()??(0,a.Wm)(g.l,{title:n(e.noDataText)},null)),l["prepend-item"]?.(),z.value.map(((t,n)=>{const u=(0,a.dG)(t.props,{key:n,active:!(!B.value||0!==n)||void 0,onClick:()=>ne(t)});return l.item?.({item:t,index:n,props:u})??(0,a.Wm)(g.l,u,{prepend:l=>{let{isSelected:n}=l;return(0,a.Wm)(a.HY,null,[e.multiple&&!e.hideSelected?(0,a.Wm)(m.p,{key:t.value,modelValue:n,ripple:!1,tabindex:"-1"},null):void 0,t.props.prependIcon&&(0,a.Wm)(h.t,{icon:t.props.prependIcon},null)])},title:()=>s.value?t.title:j(t.title,P(t)?.title,O.value?.length??0)})})),l["append-item"]?.()]})]}),Z.value.map(((n,u)=>{function i(e){e.stopPropagation(),e.preventDefault(),ne(n)}const s={"onClick:close":i,onMousedown(e){e.preventDefault(),e.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0};return(0,a.Wm)("div",{key:n.value,class:["v-autocomplete__selection",u===p.value&&["v-autocomplete__selection--selected",D.value]],style:u===p.value?A.value:{}},[t?l.chip?(0,a.Wm)(f.z,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:n.title}}},{default:()=>[l.chip?.({item:n,index:u,props:s})]}):(0,a.Wm)(o.v,(0,a.dG)({key:"chip",closable:e.closableChips,size:"small",text:n.title},s),null):l.selection?.({item:n,index:u})??(0,a.Wm)("span",{class:"v-autocomplete__selection-text"},[n.title,e.multiple&&u<Z.value.length-1&&(0,a.Wm)("span",{class:"v-autocomplete__selection-comma"},[(0,a.Uk)(",")])])])}))]),"append-inner":function(){for(var t=arguments.length,n=new Array(t),u=0;u<t;u++)n[u]=arguments[u];return(0,a.Wm)(a.HY,null,[l["append-inner"]?.(...n),e.menuIcon?(0,a.Wm)(h.t,{class:"v-autocomplete__menu-icon",icon:e.menuIcon,onMousedown:$,onClick:S.ZT},null):void 0])}})})),(0,C.F)({isFocused:i,isPristine:s,menu:d,search:O,filteredItems:E,select:ne},u)}});function Y(e,t,l,n,u,o){return(0,a.wg)(),(0,a.j4)(T,{modelValue:e.model,"onUpdate:modelValue":t[0]||(t[0]=t=>e.model=t),items:e.items,loading:e.isLoading,search:e.inputChange,"onUpdate:search":t[1]||(t[1]=t=>e.inputChange=t),"item-title":"title","item-value":"id",label:"搜索电影...","no-data-text":"没有找到相关电影"},null,8,["modelValue","items","loading","search"])}var E=l(3020),P={data:()=>({isLoading:!1,items:[],model:null,inputChange:null,search:null,tab:null,value:null}),emits:["idSearched"],watch:{model(e){this.$emit("idSearched",e)},inputChange(e){this.timer&&clearTimeout(this.timer),e?this.timer=setTimeout((()=>{this.remoteSearch(e)}),300):this.items=[]}},methods:{remoteSearch(e){this.isLoading=!0,E.Z.search(e).then((e=>this.items=e)).finally((()=>this.isLoading=!1))}}},Z=l(89);const z=(0,Z.Z)(P,[["render",Y]]);var R=z,X=l(8325),B={components:{SearchWidget:R,MovieCard:X.Z},created(){this.fetchData()},data(){return{id:343611,history:[]}},methods:{async getId(e){this.id=e,await E.Z.history.onSearched(e),this.fetchData()},fetchData(){E.Z.history.readSearched().then((e=>this.history=e))},async clearHistory(){await E.Z.history.clear(),this.fetchData()}}};const G=(0,Z.Z)(B,[["render",d]]);var N=G}}]);
//# sourceMappingURL=634.072769af.js.map