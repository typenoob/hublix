"use strict";(self["webpackChunkhublix"]=self["webpackChunkhublix"]||[]).push([[333],{9807:function(e,a,t){t.r(a),t.d(a,{default:function(){return B}});var l=t(3396),i=t(3369),s=t(6824),n=t(8521),r=t(8281),o=t(4960),u=t(2718),v=t(9166),d=t(9694),p=t(2465),c=t(4231),g=t(9374),f=t(1138),h=t(7041),m=t(5221),b=t(6107),y=t(8157),L=t(1629),V=t(8717),_=t(4870);function P(){const e=(0,_.iH)([]);function a(a,t){e.value[t]=a}return(0,l.Xn)((()=>e.value=[])),{refs:e,updateRef:a}}var x=t(3712),w=t(3766),W=t(1107),I=t(131),k=t(9888);const S=(0,w.U)({activeColor:String,start:{type:[Number,String],default:1},modelValue:{type:Number,default:e=>e.start},disabled:Boolean,length:{type:[Number,String],default:1,validator:e=>e%1===0},totalVisible:[Number,String],firstIcon:{type:o.lE,default:"$first"},prevIcon:{type:o.lE,default:"$prev"},nextIcon:{type:o.lE,default:"$next"},lastIcon:{type:o.lE,default:"$last"},ariaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.root"},pageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.page"},currentPageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.currentPage"},firstAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.first"},previousAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.previous"},nextAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.next"},lastAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.last"},ellipsis:{type:String,default:"..."},showFirstLastPage:Boolean,...(0,u.m)(),...(0,v.l)(),...(0,d.f)(),...(0,p.c)(),...(0,c.I)(),...(0,g.Z)(),...(0,f.Q)({tag:"nav"}),...(0,h.x$)(),...(0,m.bk)({variant:"text"})},"v-pagination"),A=(0,W.ev)()({name:"VPagination",props:S(),emits:{"update:modelValue":e=>!0,first:e=>!0,prev:e=>!0,next:e=>!0,last:e=>!0},setup(e,a){let{slots:t,emit:i}=a;const s=(0,V.z)(e,"modelValue"),{t:n,n:o}=(0,L.bU)(),{isRtl:u}=(0,L.Vw)(),{themeClasses:v}=(0,h.ER)(e),{width:d}=(0,y.AW)(),p=(0,_.XI)(-1);(0,b.AF)(void 0,{scoped:!0});const{resizeRef:c}=(0,x.y)((e=>{if(!e.length)return;const{target:a,contentRect:t}=e[0],l=a.querySelector(".v-pagination__list > *");if(!l)return;const i=t.width,s=l.offsetWidth+2*parseFloat(getComputedStyle(l).marginRight);p.value=w(i,s)})),g=(0,l.Fl)((()=>parseInt(e.length,10))),f=(0,l.Fl)((()=>parseInt(e.start,10))),m=(0,l.Fl)((()=>e.totalVisible?parseInt(e.totalVisible,10):p.value>=0?p.value:w(d.value,58)));function w(a,t){const l=e.showFirstLastPage?5:3;return Math.max(0,Math.floor(+((a-t*l)/t).toFixed(2)))}const W=(0,l.Fl)((()=>{if(g.value<=0||isNaN(g.value)||g.value>Number.MAX_SAFE_INTEGER)return[];if(m.value<=1)return[s.value];if(g.value<=m.value)return(0,I.MT)(g.value,f.value);const a=m.value%2===0,t=a?m.value/2:Math.floor(m.value/2),l=a?t:t+1,i=g.value-t;if(l-s.value>=0)return[...(0,I.MT)(Math.max(1,m.value-1),f.value),e.ellipsis,g.value];if(s.value-i>=(a?1:0)){const a=m.value-1,t=g.value-a+f.value;return[f.value,e.ellipsis,...(0,I.MT)(a,t)]}{const a=Math.max(1,m.value-3),t=1===a?s.value:s.value-Math.ceil(a/2)+f.value;return[f.value,e.ellipsis,...(0,I.MT)(a,t),e.ellipsis,g.value]}}));function S(e,a,t){e.preventDefault(),s.value=a,t&&i(t,a)}const{refs:A,updateRef:M}=P();(0,b.AF)({VPaginationBtn:{color:(0,_.Vh)(e,"color"),border:(0,_.Vh)(e,"border"),density:(0,_.Vh)(e,"density"),size:(0,_.Vh)(e,"size"),variant:(0,_.Vh)(e,"variant"),rounded:(0,_.Vh)(e,"rounded"),elevation:(0,_.Vh)(e,"elevation")}});const F=(0,l.Fl)((()=>W.value.map(((a,t)=>{const l=e=>M(e,t);if("string"===typeof a)return{isActive:!1,key:`ellipsis-${t}`,page:a,props:{ref:l,ellipsis:!0,icon:!0,disabled:!0}};{const t=a===s.value;return{isActive:t,key:a,page:o(a),props:{ref:l,ellipsis:!1,icon:!0,disabled:!!e.disabled||+e.length<2,color:t?e.activeColor:e.color,ariaCurrent:t,ariaLabel:n(t?e.currentPageAriaLabel:e.pageAriaLabel,a),onClick:e=>S(e,a)}}}})))),C=(0,l.Fl)((()=>{const a=!!e.disabled||s.value<=f.value,t=!!e.disabled||s.value>=f.value+g.value-1;return{first:e.showFirstLastPage?{icon:u.value?e.lastIcon:e.firstIcon,onClick:e=>S(e,f.value,"first"),disabled:a,ariaLabel:n(e.firstAriaLabel),ariaDisabled:a}:void 0,prev:{icon:u.value?e.nextIcon:e.prevIcon,onClick:e=>S(e,s.value-1,"prev"),disabled:a,ariaLabel:n(e.previousAriaLabel),ariaDisabled:a},next:{icon:u.value?e.prevIcon:e.nextIcon,onClick:e=>S(e,s.value+1,"next"),disabled:t,ariaLabel:n(e.nextAriaLabel),ariaDisabled:t},last:e.showFirstLastPage?{icon:u.value?e.firstIcon:e.lastIcon,onClick:e=>S(e,f.value+g.value-1,"last"),disabled:t,ariaLabel:n(e.lastAriaLabel),ariaDisabled:t}:void 0}}));function $(){const e=s.value-f.value;A.value[e]?.$el.focus()}function R(a){a.key===I.ff.left&&!e.disabled&&s.value>+e.start?(s.value=s.value-1,(0,l.Y3)($)):a.key===I.ff.right&&!e.disabled&&s.value<f.value+g.value-1&&(s.value=s.value+1,(0,l.Y3)($))}return(0,k.L)((()=>(0,l.Wm)(e.tag,{ref:c,class:["v-pagination",v.value,e.class],style:e.style,role:"navigation","aria-label":n(e.ariaLabel),onKeydown:R,"data-test":"v-pagination-root"},{default:()=>[(0,l.Wm)("ul",{class:"v-pagination__list"},[e.showFirstLastPage&&(0,l.Wm)("li",{key:"first",class:"v-pagination__first","data-test":"v-pagination-first"},[t.first?t.first(C.value.first):(0,l.Wm)(r.T,(0,l.dG)({_as:"VPaginationBtn"},C.value.first),null)]),(0,l.Wm)("li",{key:"prev",class:"v-pagination__prev","data-test":"v-pagination-prev"},[t.prev?t.prev(C.value.prev):(0,l.Wm)(r.T,(0,l.dG)({_as:"VPaginationBtn"},C.value.prev),null)]),F.value.map(((e,a)=>(0,l.Wm)("li",{key:e.key,class:["v-pagination__item",{"v-pagination__item--is-active":e.isActive}],"data-test":"v-pagination-item"},[t.item?t.item(e):(0,l.Wm)(r.T,(0,l.dG)({_as:"VPaginationBtn"},e.props),{default:()=>[e.page]})]))),(0,l.Wm)("li",{key:"next",class:"v-pagination__next","data-test":"v-pagination-next"},[t.next?t.next(C.value.next):(0,l.Wm)(r.T,(0,l.dG)({_as:"VPaginationBtn"},C.value.next),null)]),e.showFirstLastPage&&(0,l.Wm)("li",{key:"last",class:"v-pagination__last","data-test":"v-pagination-last"},[t.last?t.last(C.value.last):(0,l.Wm)(r.T,(0,l.dG)({_as:"VPaginationBtn"},C.value.last),null)])])]}))),{}}});var M=t(7540);const F={class:"text-center"};function C(e,a,t,r,o,u){const v=(0,l.up)("MovieCard");return(0,l.wg)(),(0,l.j4)(i.K,null,{default:(0,l.w5)((()=>[(0,l.Wm)(s.o,null,{default:(0,l.w5)((()=>[(0,l.Wm)(n.D,{cols:"3"},{default:(0,l.w5)((()=>[o.visible?((0,l.wg)(),(0,l.j4)(M.rL,{key:0,modelValue:o.genresSelect,"onUpdate:modelValue":a[0]||(a[0]=e=>o.genresSelect=e),items:o.genres.map((e=>e.name)),label:"类型",variant:"plain"},null,8,["modelValue","items"])):(0,l.kq)("",!0)])),_:1}),(0,l.Wm)(n.D,{cols:"3"},{default:(0,l.w5)((()=>[(0,l.Wm)(M.rL,{dense:"",height:"30px","loader-height":"1",modelValue:o.year,"onUpdate:modelValue":a[1]||(a[1]=e=>o.year=e),items:["全部"].concat(u.years),label:"发行年份",variant:"plain"},null,8,["modelValue","items"])])),_:1}),(0,l.Wm)(n.D,{cols:"3"},{default:(0,l.w5)((()=>[(0,l.Wm)(M.rL,{modelValue:o.sort,"onUpdate:modelValue":a[2]||(a[2]=e=>o.sort=e),items:o.sorts.map((e=>e.label)),label:"排序",variant:"plain"},null,8,["modelValue","items"])])),_:1}),(0,l.Wm)(n.D,{cols:"3"},{default:(0,l.w5)((()=>[(0,l.Wm)(M.rL,{modelValue:o.perPage,"onUpdate:modelValue":a[3]||(a[3]=e=>o.perPage=e),items:["2","4","6","8"],attach:"",label:"每页显示",variant:"plain"},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(s.o,{class:"mt-n9 mb-5"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(u.currentIds,(e=>((0,l.wg)(),(0,l.j4)(n.D,{key:e,cols:"6"},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{id:e},null,8,["id"])])),_:2},1024)))),128))])),_:1}),(0,l._)("div",F,[(0,l.Wm)(A,{modelValue:o.page,"onUpdate:modelValue":a[4]||(a[4]=e=>o.page=e),rounded:"",density:"compact","prev-icon":"mdi-menu-left","next-icon":"mdi-menu-right","total-visible":"6",length:(o.totalResults-1)/o.perPage+1>999?999:parseInt((o.totalResults-1)/o.perPage+1)},null,8,["modelValue","length"])])])),_:1})}var $=t(3020),R=t(8325),D={setup(){},components:{MovieCard:R.Z},created(){$.Z.genres().then((e=>{this.genres.push(...e),console.log(this.genres)})),this.fetchMovie()},data(){return{visible:!0,totalResults:0,genres:[{name:"全部"}],genresSelect:"全部",sorts:[{label:"人气",name:"popularity"},{label:"发布日期",name:"release_date"},{label:"盈利",name:"revenue"},{label:"平均分数",name:"vote_average"},{label:"评分次数",name:"vote_count"}],sort:"人气",ids:[],page:1,perPage:"4",fetchPage:1,year:"全部"}},computed:{currentIds(){return this.ids.slice((this.page-1)*this.perPage,this.page*this.perPage)},years(){return Array.from({length:20},((e,a)=>(-a+(new Date).getFullYear()).toString()))},genresId(){return this.genres.find((e=>e.name===this.genresSelect))?.id},sortName(){return this.sorts.find((e=>e.label===this.sort)).name},filter(){const{genresSelect:e,year:a,sort:t}=this;return{genresSelect:e,year:a,sort:t}}},watch:{page(e){e*this.perPage>=this.ids.length&&(this.fetchPage=parseInt((e*this.perPage-1)/20)+1,this.fetchMovie())},genresSelect(e){0==e.length&&(this.visible=!0),this.fetchPage=1,this.ids=[],this.fetchMovie()},year(){this.fetchPage=1,this.ids=[],this.fetchMovie()},filter:{handler(){this.fetchPage=1,this.ids=[],this.fetchMovie()},deep:!0}},methods:{fetchMovie(){$.Z.filter(this.fetchPage,this.year,this.genresId,this.sortName).then((e=>{while(this.ids.length<20*this.fetchPage)this.ids.push(null);this.ids.splice(20*(this.fetchPage-1),20,...e.list),this.totalResults=e.totalResults}))}}},N=t(89);const T=(0,N.Z)(D,[["render",C]]);var B=T}}]);
//# sourceMappingURL=333.405a9684.js.map