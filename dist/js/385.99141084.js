"use strict";(self["webpackChunkhublix"]=self["webpackChunkhublix"]||[]).push([[385],{1804:function(e,a,t){t.r(a),t.d(a,{default:function(){return C}});var l=t(3396),i=t(3369),n=t(6824),s=t(8521),r=t(5101),u=t(1138),o=t(5738),v=t(9903),d=t(2465),c=t(9694),p=t(9374),g=t(7041),f=t(5221),m=t(3712),h=t(2718),b=t(4870);function y(){const e=(0,b.iH)([]);function a(a,t){e.value[t]=a}return(0,l.Xn)((()=>e.value=[])),{refs:e,updateRef:a}}var L=t(8717),V=t(8434),_=t(1107),x=t(131),w=t(4231);const S=(0,_.a)({name:"VPagination",props:{start:{type:[Number,String],default:1},modelValue:{type:Number,default:e=>e.start},disabled:Boolean,length:{type:[Number,String],default:1,validator:e=>e%1===0},totalVisible:[Number,String],firstIcon:{type:String,default:"$first"},prevIcon:{type:String,default:"$prev"},nextIcon:{type:String,default:"$next"},lastIcon:{type:String,default:"$last"},ariaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.root"},pageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.page"},currentPageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.currentPage"},firstAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.first"},previousAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.previous"},nextAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.next"},lastAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.last"},ellipsis:{type:String,default:"..."},showFirstLastPage:Boolean,...(0,w.I)(),...(0,h.m)(),...(0,c.f)(),...(0,d.c)(),...(0,p.Z)(),...(0,u.Q)({tag:"nav"}),...(0,g.x$)(),...(0,f.bk)({variant:"text"})},emits:{"update:modelValue":e=>!0,first:e=>!0,prev:e=>!0,next:e=>!0,last:e=>!0},setup(e,a){let{slots:t,emit:i}=a;const n=(0,L.z)(e,"modelValue"),{t:s,n:u}=(0,o.bU)(),{isRtl:d}=(0,v.Vw)(),{themeClasses:c}=(0,g.ER)(e),p=(0,b.iH)(-1);(0,V.AF)(void 0,{scoped:!0});const{resizeRef:f}=(0,m.y)((e=>{if(!e.length)return;const{target:a,contentRect:t}=e[0],l=a.querySelector(".v-pagination__list > *");if(!l)return;const i=t.width,n=l.getBoundingClientRect().width+10;p.value=Math.max(0,Math.floor((i-96)/n))})),h=(0,l.Fl)((()=>parseInt(e.length,10))),_=(0,l.Fl)((()=>parseInt(e.start,10))),w=(0,l.Fl)((()=>{var a;return e.totalVisible?Math.min(parseInt(null!=(a=e.totalVisible)?a:"",10),h.value):p.value>=0?p.value:h.value})),S=(0,l.Fl)((()=>{if(h.value<=0)return[];if(w.value<=2)return[n.value];if(h.value<=w.value)return(0,x.MT)(h.value,_.value);const a=w.value%2===0,t=a?w.value/2:Math.floor(w.value/2),l=a?t:t+1,i=h.value-t;if(l-n.value>=0)return[...(0,x.MT)(Math.max(1,w.value-1),_.value),e.ellipsis,h.value];if(n.value-i>=0){const a=w.value-1,t=h.value-a+_.value;return[_.value,e.ellipsis,...(0,x.MT)(a,t)]}{const a=Math.max(1,w.value-3),t=1===a?n.value:n.value-Math.ceil(a/2)+_.value;return[_.value,e.ellipsis,...(0,x.MT)(a,t),e.ellipsis,h.value]}}));function W(e,a,t){e.preventDefault(),n.value=a,t&&i(t,a)}const{refs:I,updateRef:P}=y();(0,V.AF)({VBtn:{border:(0,b.Vh)(e,"border"),density:(0,b.Vh)(e,"density"),size:(0,b.Vh)(e,"size"),variant:(0,b.Vh)(e,"variant")}});const M=(0,l.Fl)((()=>S.value.map(((a,t)=>{const l=e=>P(e,t);if("string"===typeof a)return{isActive:!1,page:a,props:{ref:l,ellipsis:!0,icon:!0,disabled:!0}};{const i=a===n.value;return{isActive:i,page:u(a),props:{ref:l,ellipsis:!1,icon:!0,disabled:!!e.disabled||e.length<2,elevation:e.elevation,rounded:e.rounded,color:i?e.color:void 0,ariaCurrent:i,ariaLabel:s(i?e.currentPageAriaLabel:e.pageAriaLabel,t+1),onClick:e=>W(e,a)}}}})))),k=(0,l.Fl)((()=>{const a=!!e.disabled||n.value<=_.value,t=!!e.disabled||n.value>=_.value+h.value-1;return{first:e.showFirstLastPage?{icon:d.value?e.lastIcon:e.firstIcon,onClick:e=>W(e,_.value,"first"),disabled:a,ariaLabel:s(e.firstAriaLabel),ariaDisabled:a}:void 0,prev:{icon:d.value?e.nextIcon:e.prevIcon,onClick:e=>W(e,n.value-1,"prev"),disabled:a,ariaLabel:s(e.previousAriaLabel),ariaDisabled:a},next:{icon:d.value?e.prevIcon:e.nextIcon,onClick:e=>W(e,n.value+1,"next"),disabled:t,ariaLabel:s(e.nextAriaLabel),ariaDisabled:t},last:e.showFirstLastPage?{icon:d.value?e.firstIcon:e.lastIcon,onClick:e=>W(e,_.value+h.value-1,"last"),disabled:t,ariaLabel:s(e.lastAriaLabel),ariaDisabled:t}:void 0}}));function A(){var e;const a=n.value-_.value;null==(e=I.value[a])||e.$el.focus()}function F(a){a.key===x.ff.left&&!e.disabled&&n.value>e.start?(n.value=n.value-1,(0,l.Y3)(A)):a.key===x.ff.right&&!e.disabled&&n.value<_.value+h.value-1&&(n.value=n.value+1,(0,l.Y3)(A))}return()=>(0,l.Wm)(e.tag,{ref:f,class:["v-pagination",c.value],role:"navigation","aria-label":s(e.ariaLabel),onKeydown:F,"data-test":"v-pagination-root"},{default:()=>[(0,l.Wm)("ul",{class:"v-pagination__list"},[e.showFirstLastPage&&(0,l.Wm)("li",{class:"v-pagination__first","data-test":"v-pagination-first"},[t.first?t.first(k.value.first):(0,l.Wm)(r.T,k.value.first,null)]),(0,l.Wm)("li",{class:"v-pagination__prev","data-test":"v-pagination-prev"},[t.prev?t.prev(k.value.prev):(0,l.Wm)(r.T,k.value.prev,null)]),M.value.map(((e,a)=>(0,l.Wm)("li",{key:`${a}_${e.page}`,class:["v-pagination__item",{"v-pagination__item--is-active":e.isActive}],"data-test":"v-pagination-item"},[t.item?t.item(e):(0,l.Wm)(r.T,e.props,{default:()=>[e.page]})]))),(0,l.Wm)("li",{class:"v-pagination__next","data-test":"v-pagination-next"},[t.next?t.next(k.value.next):(0,l.Wm)(r.T,k.value.next,null)]),e.showFirstLastPage&&(0,l.Wm)("li",{class:"v-pagination__last","data-test":"v-pagination-last"},[t.last?t.last(k.value.last):(0,l.Wm)(r.T,k.value.last,null)])])]})}});var W=t(240);const I={class:"text-center"};function P(e,a,t,r,u,o){const v=(0,l.up)("MovieCard");return(0,l.wg)(),(0,l.j4)(i.K,null,{default:(0,l.w5)((()=>[(0,l.Wm)(n.o,null,{default:(0,l.w5)((()=>[(0,l.Wm)(s.D,{cols:"3"},{default:(0,l.w5)((()=>[u.visible?((0,l.wg)(),(0,l.j4)(W.r,{key:0,onFocus:a[0]||(a[0]=e=>o.onFocus()),modelValue:u.all,"onUpdate:modelValue":a[1]||(a[1]=e=>u.all=e),items:["全部"],label:"类型",variant:"plain"},null,8,["modelValue"])):((0,l.wg)(),(0,l.j4)(W.r,{key:1,ref:"select",id:"select",modelValue:u.genresSelect,"onUpdate:modelValue":a[2]||(a[2]=e=>u.genresSelect=e),items:u.genres.map((e=>e.name)),chips:"",label:"类型",variant:"plain",multiple:""},null,8,["modelValue","items"]))])),_:1}),(0,l.Wm)(s.D,{cols:"3"},{default:(0,l.w5)((()=>[(0,l.Wm)(W.r,{dense:"",height:"30px","loader-height":"1",modelValue:u.year,"onUpdate:modelValue":a[3]||(a[3]=e=>u.year=e),items:["全部"].concat(o.years),label:"发行年份",variant:"plain"},null,8,["modelValue","items"])])),_:1}),(0,l.Wm)(s.D,{cols:"3"},{default:(0,l.w5)((()=>[(0,l.Wm)(W.r,{modelValue:u.sort,"onUpdate:modelValue":a[4]||(a[4]=e=>u.sort=e),items:u.sorts.map((e=>e.label)),label:"排序",variant:"plain"},null,8,["modelValue","items"])])),_:1}),(0,l.Wm)(s.D,{cols:"3"},{default:(0,l.w5)((()=>[(0,l.Wm)(W.r,{modelValue:u.perPage,"onUpdate:modelValue":a[5]||(a[5]=e=>u.perPage=e),items:["2","4","6","8"],attach:"",label:"每页显示",variant:"plain"},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(n.o,{class:"mt-n9 mb-5"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(o.currentIds,(e=>((0,l.wg)(),(0,l.j4)(s.D,{key:e,cols:"6"},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{id:e},null,8,["id"])])),_:2},1024)))),128))])),_:1}),(0,l._)("div",I,[(0,l.Wm)(S,{modelValue:u.page,"onUpdate:modelValue":a[6]||(a[6]=e=>u.page=e),"prev-icon":"mdi-menu-left","next-icon":"mdi-menu-right",length:6},null,8,["modelValue"])])])),_:1})}var M=t(3020),k=t(789),A={setup(){},components:{MovieCard:k.Z},created(){this.fetchMovie(),M.Z.genres().then((e=>{this.genres=e}))},data(){return{visible:!0,all:"全部",genres:[],genresSelect:[],sorts:[{label:"人气",name:"popularity"},{label:"发布日期",name:"release_date"},{label:"盈利",name:"revenue"},{label:"平均分数",name:"vote_average"},{label:"评分次数",name:"vote_count"}],sort:"人气",ids:[],page:1,perPage:"4",fetchPage:1,year:"全部"}},computed:{currentIds(){return this.ids.slice((this.page-1)*this.perPage,this.page*this.perPage)},years(){return Array.from({length:20},((e,a)=>(-a+(new Date).getFullYear()).toString()))},genresId(){return this.genres.find((e=>e.name===this.genresSelect[0]))?.id},sortName(){return this.sorts.find((e=>e.label===this.sort)).name},filter(){const{genresSelect:e,year:a,sort:t}=this;return{genresSelect:e,year:a,sort:t}}},watch:{page(e){e*this.perPage>=this.ids.length&&this.fetchMovie()},genresSelect(e){0==e.length&&(this.visible=!0),this.fetchPage=1,this.ids=[],this.fetchMovie()},year(){this.fetchPage=1,this.ids=[],this.fetchMovie()},filter:{handler(){this.fetchPage=1,this.ids=[],this.fetchMovie()},deep:!0}},methods:{fetchMovie(){M.Z.filter(this.fetchPage++,this.year,this.genresId,this.sortName).then((e=>{this.ids.push(...e)}))},onFocus(){this.visible=!1,this.$nextTick((function(){document.getElementById("select").click()}))}}},F=t(89);const $=(0,F.Z)(A,[["render",P]]);var C=$}}]);
//# sourceMappingURL=385.99141084.js.map