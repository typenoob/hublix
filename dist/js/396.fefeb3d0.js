"use strict";(self["webpackChunkhublix"]=self["webpackChunkhublix"]||[]).push([[396],{8394:function(e,t,l){l.r(t),l.d(t,{default:function(){return P}});var n=l(3396),a=l(7139),i=l(7229),u=l(7103),o=l(3369),s=l(6824),r=l(8521);const c=(0,n.Uk)("搜索历史"),d=(0,n.Uk)("清空");function v(e,t,l,v,m,f){const h=(0,n.up)("SearchWidget"),p=(0,n.up)("MovieCard");return(0,n.wg)(),(0,n.j4)(o.K,null,{default:(0,n.w5)((()=>[(0,n.Wm)(h,{onIdSearched:f.getId},null,8,["onIdSearched"]),(0,n.Wm)(i._,{class:"pt-4 px-2 mb-10",flat:""},{default:(0,n.w5)((()=>[(0,n.Wm)(s.o,{class:""},{default:(0,n.w5)((()=>[(0,n.Wm)(r.D,null,{default:(0,n.w5)((()=>[c])),_:1}),(0,n.Wm)(r.D,{class:"d-flex justify-end",onClick:t[0]||(t[0]=e=>f.clearHistory()),style:{}},{default:(0,n.w5)((()=>[d])),_:1})])),_:1}),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(m.history,((e,t)=>((0,n.wg)(),(0,n.j4)(u.v,{class:"ma-2",key:t,onClick:t=>m.id=e.id,"x-small":""},{default:(0,n.w5)((()=>[(0,n.Uk)((0,a.zw)(e.name),1)])),_:2},1032,["onClick"])))),128))])),_:1}),(0,n.Wm)(p,{id:m.id},null,8,["id"])])),_:1})}l(1703),l(6699);var m=l(240),f=l(836),h=l(6052),p=l(1358),y=l(4193),g=l(2902),k=l(3766),w=l(131),C=l(4870);const b=(e,t,l)=>null==e||null==t?-1:e.toString().toLocaleLowerCase().indexOf(t.toString().toLocaleLowerCase()),W=(0,k.U)({customFilter:Function,customKeyFilter:Object,filterKeys:[Array,String],filterMode:{type:String,default:"intersection"},noFilter:Boolean},"filter");function _(e,t,l){var n,a;const i=[],u=null!=(n=null==l?void 0:l.default)?n:b,o=!(null==l||!l.filterKeys)&&(0,w.FT)(l.filterKeys),s=Object.keys(null!=(a=null==l?void 0:l.customKeyFilter)?a:{}).length;if(null==e||!e.length)return i;e:for(const c of e){const e={},n={};let a=-1;if(t&&"object"===typeof c&&(null==l||!l.noFilter)){const i=o||Object.keys(c);for(const o of i){var r;const i=(0,w.qF)(c,o,c),s=null==l||null==(r=l.customKeyFilter)?void 0:r[o];if(a=s?s(i,t,c):u(i,t,c),-1!==a&&!1!==a)s?e[o]=a:n[o]=a;else if("every"===(null==l?void 0:l.filterMode))continue e}const d=Object.keys(n).length,v=Object.keys(e).length;if(!d&&!v)continue;if("union"===(null==l?void 0:l.filterMode)&&v!==s&&!d)continue;if("intersection"===(null==l?void 0:l.filterMode)&&(v!==s||!d))continue}i.push({item:c,matches:{...n,...e}})}return i}function F(e,t,l){const a=(0,n.Fl)((()=>"string"!==typeof(null==l?void 0:l.value)&&"number"!==typeof(null==l?void 0:l.value)?"":String(l.value))),i=(0,n.Fl)((()=>_((0,C.SU)(t),a.value,{customKeyFilter:e.customKeyFilter,default:e.customFilter,filterKeys:e.filterKeys,filterMode:e.filterMode,noFilter:e.noFilter})));return{filteredItems:i}}var S=l(4906),K=l(6185),D=l(6199),x=l(5738),I=l(8717),H=l(1107),V=l(9888);function j(e,t,l){if(Array.isArray(t))throw new Error("Multiple matches is not implemented");return"number"===typeof t&&~t?(0,n.Wm)(n.HY,null,[(0,n.Wm)("span",{class:"v-autocomplete__unmask"},[e.substr(0,t)]),(0,n.Wm)("span",{class:"v-autocomplete__mask"},[e.substr(t,l)]),(0,n.Wm)("span",{class:"v-autocomplete__unmask"},[e.substr(t+l)])]):e}const L=(0,H.e)()({name:"VAutocomplete",props:{search:String,...W({filterKeys:["title"]}),...(0,m.f)(),...(0,S.X)({transition:!1})},emits:{"click:clear":e=>!0,"update:search":e=>!0,"update:modelValue":e=>!0},setup(e,t){let{slots:l}=t;const{t:a}=(0,x.bU)(),i=(0,C.iH)(),o=(0,C.iH)(),s=(0,C.iH)(!1),r=(0,C.iH)(!0),c=(0,C.iH)(!1),{items:d}=(0,K.Ce)(e),v=(0,I.z)(e,"search",""),m=(0,I.z)(e,"modelValue",[],(e=>(0,w.FT)(e||[])),(t=>e.multiple?t:t[0])),{filteredItems:k}=F(e,d,(0,n.Fl)((()=>r.value?void 0:v.value))),b=(0,n.Fl)((()=>{const t=[];let l=0;for(const n of m.value){const a=(0,K.Nb)(e,n),i=t.find((e=>e.value===a.value));null==i&&(t.push({...a,index:l}),l++)}return t})),W=(0,n.Fl)((()=>b.value.map((e=>e.value))));function _(t){m.value=[],e.openOnClear&&(c.value=!0),v.value=""}function S(){e.hideNoData&&!k.value.length||(c.value=!0)}function H(e){["Enter","ArrowDown"].includes(e.key)&&(c.value=!0),["Escape"].includes(e.key)&&(c.value=!1),["Enter","Escape","Tab"].includes(e.key)&&(r.value=!0)}function L(e){v.value=e.target.value}function M(){s.value&&(r.value=!0)}const U=(0,C.iH)(!1);function O(t){if(e.multiple){const e=W.value.findIndex((e=>e===t.value));if(-1===e)m.value=[...m.value,t.value];else{const t=[...m.value];t.splice(e,1),m.value=t}}else m.value=[t.value],U.value=!0,v.value=t.title,c.value=!1,r.value=!0,(0,n.Y3)((()=>U.value=!1))}return(0,n.YP)((()=>i.value),(e=>{o.value=e.$el.querySelector(".v-input__control")})),(0,n.YP)(s,(t=>{var l;t?(U.value=!0,v.value=e.multiple?"":String(null!=(l=m.value)?l:""),r.value=!0,(0,n.Y3)((()=>U.value=!1))):(c.value=!1,v.value="")})),(0,n.YP)(v,(e=>{s.value&&!U.value&&(e&&(c.value=!0),r.value=!e)})),(0,V.L)((()=>{const t=!(!e.chips&&!l.chip);return(0,n.Wm)(g.h,{ref:i,modelValue:v.value,onInput:L,class:["v-autocomplete",{"v-autocomplete--active-menu":c.value,"v-autocomplete--chips":!!e.chips,["v-autocomplete--"+(e.multiple?"multiple":"single")]:!0}],appendInnerIcon:e.menuIcon,dirty:W.value.length>0,"onClick:clear":_,"onClick:control":S,"onClick:input":S,onFocus:()=>s.value=!0,onBlur:()=>s.value=!1,onKeydown:H},{...l,default:()=>{var i,s;return(0,n.Wm)(n.HY,null,[o.value&&(0,n.Wm)(y.T,{modelValue:c.value,"onUpdate:modelValue":e=>c.value=e,activator:o.value,contentClass:"v-autocomplete__content",eager:e.eager,openOnClick:!1,transition:e.transition,onAfterLeave:M},{default:()=>[(0,n.Wm)(h.i,{selected:W.value,selectStrategy:e.multiple?"independent":"single-independent"},{default:()=>[!k.value.length&&!e.hideNoData&&(null!=(i=null==(s=l["no-data"])?void 0:s.call(l))?i:(0,n.Wm)(p.l,{title:a(e.noDataText)},null)),k.value.map((e=>{let{item:t,matches:l}=e;return(0,n.Wm)(p.l,{value:t.value,onMousedown:e=>e.preventDefault(),onClick:()=>O(t)},{title:()=>{var e,n;return r.value?t.title:j(t.title,l.title,null!=(e=null==(n=v.value)?void 0:n.length)?e:0)}})}))]})]}),b.value.map(((a,i)=>{function o(e){e.stopPropagation(),e.preventDefault(),O(a)}const s={"onClick:close":o,modelValue:!0};return(0,n.Wm)("div",{class:"v-autocomplete__selection"},[t&&(0,n.Wm)(f.z,{defaults:{VChip:{closable:e.closableChips,size:"small",text:a.title}}},{default:()=>[l.chip?l.chip({props:s,selection:a}):(0,n.Wm)(u.v,s,null)]}),!t&&(l.selection?l.selection({selection:a}):(0,n.Wm)("span",{class:"v-autocomplete__selection-text"},[a.title,e.multiple&&i<b.value.length-1&&(0,n.Wm)("span",{class:"v-autocomplete__selection-comma"},[(0,n.Uk)(",")])]))])}))])}})})),(0,D.Z)({filteredItems:k},i)}});function M(e,t,l,a,i,u){return(0,n.wg)(),(0,n.j4)(L,{modelValue:e.model,"onUpdate:modelValue":t[0]||(t[0]=t=>e.model=t),items:e.items,loading:e.isLoading,search:e.inputChange,"onUpdate:search":t[1]||(t[1]=t=>e.inputChange=t),"item-title":"title","item-value":"id",label:"搜索电影...","no-data-text":"没有找到相关电影"},null,8,["modelValue","items","loading","search"])}var U=l(3020),O={data:()=>({isLoading:!1,items:[],model:null,inputChange:null,search:null,tab:null,value:null}),emits:["idSearched"],watch:{model(e){this.$emit("idSearched",e)},inputChange(e){this.timer&&clearTimeout(this.timer),e?this.timer=setTimeout((()=>{this.remoteSearch(e)}),300):this.items=[]}},methods:{remoteSearch(e){this.isLoading=!0,U.Z.search(e).then((e=>this.items=e)).finally((()=>this.isLoading=!1))}}},Y=l(89);const Z=(0,Y.Z)(O,[["render",M]]);var T=Z,A=l(789),z={components:{SearchWidget:T,MovieCard:A.Z},created(){this.fetchData()},data(){return{id:343611,history:[]}},methods:{async getId(e){this.id=e,await U.Z.history.onSearched(e),this.fetchData()},fetchData(){U.Z.history.readSearched().then((e=>this.history=e))},async clearHistory(){await U.Z.history.clear(),this.fetchData()}}};const E=(0,Y.Z)(z,[["render",v]]);var P=E}}]);
//# sourceMappingURL=396.fefeb3d0.js.map